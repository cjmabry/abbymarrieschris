<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Abby Marries Chris</title>
    <link rel="stylesheet" href="./styles/main.css">
    <script src='https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.js'></script>
    <link href='https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.css' rel='stylesheet' />
</head>

<body>
    <div class="row">
        <div class="col-centered">
            <img class="logo padding-top-large" src="/assets/logo.svg" alt="Abby and Chris are getting married!">
        </div>
    </div>

    <div class="container">
        <div class="row">
            <div class="col-12">
                <h1>RSVP</h1>
                <h2>Are you in?</h2>
            </div>
        </div>

        <div class="row">
            <div class="col-12">
                <form id="my-form" action="https://formspree.io/f/xnqyewdg" method="POST">
                    <label>Your Name:</label>
                    <input type="text" name="name" required />

                    <fieldset>
                        <legend>Will you be joining us?</legend>

                        <div>
                            <input type="radio" name="rsvp" value="yes" checked>
                            <label for="yes">Totally (Yes)</label>
                        </div>

                        <div>
                            <input type="radio" name="rsvp" value="no">
                            <label for="no">Bummer (No)</label>
                        </div>
                    </fieldset>

                    <label for="party_size">How many people are in your party?</label>

                    <select name="party_size" id="party_size">
                        <option value="0">0</option>
                        <option value="1">1</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                        <option value="5">5</option>
                        <option value="6">6</option>
                    </select>


                    <label>Guest Names:</label>
                    <input type="text" name="name" required />

                    <p>Due to limited seating, we have reserved a seat for each person addressed on the envelope of your invitation. Please do not RSVP additional guests.</p>
                

                    <p>Leave your preferred method of contact in case we need to get in touch!</p>
                    <label>Phone:</label>
                    <input type="tel" id="phone" name="phone">
                    <label>Email:</label>
                    <input type="email" name="email" />

                    <p>Anything you want to share with the bride and groom?</p>
                    <label>Message:</label>
                    <textarea type="text" name="message" rows="5"></textarea>
                    <button id="my-form-button">Submit</button>
                    <p id="my-form-status"></p>
                    <input type="text" name="_gotcha" style="display:none" />
                    <!-- email, phone, name, yes or no, number attending -->
                </form>
            </div>
        </div>
    </div>

    <!-- Scripts! -->
    <script>
        var form = document.getElementById("my-form");

        async function handleSubmit(event) {
            event.preventDefault();
            var status = document.getElementById("my-form-status");
            var data = new FormData(event.target);
            fetch(event.target.action, {
                method: form.method,
                body: data,
                headers: {
                    'Accept': 'application/json'
                }
            }).then(response => {
                if (response.ok) {
                    status.innerHTML = "Thanks for your submission!";
                    form.reset()
                } else {
                    response.json().then(data => {
                        if (Object.hasOwn(data, 'errors')) {
                            status.innerHTML = data["errors"].map(error => error["message"]).join(", ")
                        } else {
                            status.innerHTML = "Oops! There was a problem submitting your form"
                        }
                    })
                }
            }).catch(error => {
                status.innerHTML = "Oops! There was a problem submitting your form"
            });
        }
        form.addEventListener("submit", handleSubmit)
    </script>
    <script src="./scripts/main.js"></script>
</body>

</html>